# 项目规划（Django + Vue3）

## 总体约束（必须遵守）
- 技术栈：后端 Django（建议配套 DRF），前端 Vue3
- 后端主 APP：django_main
- 登录认证 APP：django_auth
- API 编写方式：使用序列化器（Serializers），视图类继承 GenericAPIView

## 后端目录规划

普通 APP 目录结构强约束如下：
- urls.py
- models.py
- serializers.py
- views.py
- utils/
- migrations/

主 APP（django_main）包含统一返回格式文件：
- R.py（统一返回结构定义位置，放在主 APP 目录下）

```

manage.py
requirements.txt                  — 环境依赖
.env                             — 环境变量（放真实密钥）
django_auth/                    — 登录认证 APP（普通 APP 结构）
  urls.py
  models.py
  serializers.py
  views.py
  utils/
  migrations/
django_main/                  
  settings.py                     — 项目 settings（含 DRF 配置）
  urls.py                         — 项目路由入口（挂载 /api/auth/ 与 /api/）
  asgi.py
  wsgi.py
  R.py
```

## 各目录“写什么”的边界（关键原则）
- `django_auth/`：只做登录认证与身份相关接口（视图继承 `GenericAPIView` + 使用 `serializers.py`）。
- `django_main/`：承载知识库/文档/数据集/问答等业务接口（视图继承 `GenericAPIView` + 使用 `serializers.py`）。
- `views.py`：只做鉴权、入参校验（serializer）、调用模型层读写、返回统一结构；不堆复杂流程。
- `utils/`：仅放本 APP 内复用的工具函数/常量。

## 统一返回格式（R.py）
- 文件名：`R.py`
- 存放位置：`apps/django_main/R.py`
- 约束：所有 API（包含 django_auth 与 django_main）都使用 `R.py` 定义的统一返回结构

## API 形态建议（与你的功能匹配）
- 用户端：
  - 知识库合集选择与文档上传
  - 发起问答（返回答案 + 引用来源 + 置信/命中信息）
  - 增加/维护数据集记录（更偏台账）
- 管理端：
  - 用户管理（角色，使用Django默认用户表作为用户存储，再定义用户信息表关联用户）
  - 知识库管理（类型、合集、可见范围、生效/版本、文档状态）
  - 数据集记录管理（字段、状态流转、审计）

## 最小可行里程碑（落地优先级）
1. 认证与权限：先把“检索前过滤”做对（否则企业无法上线）
2. 文档接入：Word 解析、切分、元数据、版本与来源追踪
3. 检索与问答：混合检索 + 引用返回 + 拒答策略
4. 治理与运营：反馈闭环、命中率、缺口问题、重建索引工具
